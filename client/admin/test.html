<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - DEEPER HUB CMS</title>
    
    <!-- TuiCss Framework -->
    <link rel="stylesheet" href="../ui/TuiCss/dist/tuicss.min.css">
    <script src="../ui/TuiCss/dist/tuicss.min.js"></script>
    
    <!-- Custom Admin Styles -->
    <link rel="stylesheet" href="css/admin.css">
    
    <!-- Admin JavaScript -->
    <script src="js/utils.js"></script>
    <script src="js/components.js"></script>
    <script src="js/core/api.js"></script>
    <script src="js/core/app.js"></script>
    <script src="js/modules/pages.js"></script>
    <script src="js/modules/users.js"></script>
</head>

<body class="tui-bg-blue-black">
    <div class="tui-screen-full bordered" style="padding: 20px;">
        <h1 class="white-168-text center">üß™ DEEPER HUB CMS - Module Test</h1>
        
        <div style="margin: 20px 0;">
            <fieldset class="tui-fieldset">
                <legend>Module Status</legend>
                <div id="module-status" style="padding: 15px;">
                    <p class="secondary-text">Checking modules...</p>
                </div>
            </fieldset>
        </div>
        
        <div style="margin: 20px 0;">
            <fieldset class="tui-fieldset">
                <legend>Test Actions</legend>
                <div style="padding: 15px;">
                    <button class="admin-button primary" onclick="testNotifications()">
                        Test Notifications
                    </button>
                    <button class="admin-button success" onclick="testAPI()">
                        Test API
                    </button>
                    <button class="admin-button warning" onclick="testModules()">
                        Test Modules
                    </button>
                    <button class="admin-button secondary" onclick="testComponents()">
                        Test Components
                    </button>
                </div>
            </fieldset>
        </div>
        
        <div style="margin: 20px 0;">
            <fieldset class="tui-fieldset">
                <legend>Test Results</legend>
                <div id="test-results" style="padding: 15px; min-height: 200px;">
                    <p class="secondary-text">Run tests to see results...</p>
                </div>
            </fieldset>
        </div>
    </div>

    <script>
        // Wait for everything to load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(checkModules, 500);
        });

        function checkModules() {
            const modules = {
                'Utils': typeof Utils,
                'Components': typeof Components,
                'API': typeof API,
                'AdminApp': typeof AdminApp,
                'PagesModule': typeof PagesModule,
                'UsersModule': typeof UsersModule,
                'SettingsModule': typeof SettingsModule
            };

            let html = '<div class="row">';
            
            Object.entries(modules).forEach(([name, type]) => {
                const status = type !== 'undefined' ? '‚úÖ' : '‚ùå';
                const color = type !== 'undefined' ? 'green-168-text' : 'red-168-text';
                
                html += `
                    <div class="col-md-3" style="margin-bottom: 10px;">
                        <span class="${color}">${status}</span> 
                        <strong>${name}</strong>: ${type}
                    </div>
                `;
            });
            
            html += '</div>';
            
            document.getElementById('module-status').innerHTML = html;
        }

        function testNotifications() {
            if (typeof Components === 'undefined') {
                alert('Components not loaded!');
                return;
            }

            Components.showNotification('Test info notification', 'info');
            setTimeout(() => Components.showNotification('Test success notification', 'success'), 1000);
            setTimeout(() => Components.showNotification('Test warning notification', 'warning'), 2000);
            setTimeout(() => Components.showNotification('Test error notification', 'error'), 3000);
            
            logResult('Notifications', 'Sent 4 test notifications');
        }

        async function testAPI() {
            if (typeof API === 'undefined') {
                alert('API not loaded!');
                return;
            }

            try {
                logResult('API', 'Testing health endpoint...');
                
                const health = await API.health();
                logResult('API', `Health check: ${JSON.stringify(health)}`);
                
                Components.showNotification('API test completed!', 'success');
            } catch (error) {
                logResult('API', `Error: ${error.message}`);
                Components.showNotification('API test failed: ' + error.message, 'error');
            }
        }

        function testModules() {
            const tests = [];
            
            // Test PagesModule
            if (typeof PagesModule !== 'undefined') {
                tests.push('‚úÖ PagesModule loaded');
                if (typeof PagesModule.load === 'function') {
                    tests.push('‚úÖ PagesModule.load() available');
                }
            } else {
                tests.push('‚ùå PagesModule not loaded');
            }
            
            // Test UsersModule
            if (typeof UsersModule !== 'undefined') {
                tests.push('‚úÖ UsersModule loaded');
                if (typeof UsersModule.load === 'function') {
                    tests.push('‚úÖ UsersModule.load() available');
                }
            } else {
                tests.push('‚ùå UsersModule not loaded');
            }
            
            logResult('Modules', tests.join('<br>'));
            Components.showNotification('Module test completed!', 'info');
        }

        function testComponents() {
            if (typeof Components === 'undefined') {
                alert('Components not loaded!');
                return;
            }

            const tests = [];
            
            // Test component functions
            const functions = ['showNotification', 'createModal', 'createTable', 'createForm', 'getFormData'];
            
            functions.forEach(func => {
                if (typeof Components[func] === 'function') {
                    tests.push(`‚úÖ Components.${func}() available`);
                } else {
                    tests.push(`‚ùå Components.${func}() missing`);
                }
            });
            
            logResult('Components', tests.join('<br>'));
            Components.showNotification('Components test completed!', 'info');
        }

        function logResult(category, message) {
            const results = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            
            results.innerHTML += `
                <div style="margin-bottom: 10px; padding: 5px; border-left: 3px solid rgb(0, 255, 255);">
                    <strong class="cyan-168-text">[${timestamp}] ${category}:</strong><br>
                    <span class="white-168-text">${message}</span>
                </div>
            `;
            
            // Scroll to bottom
            results.scrollTop = results.scrollHeight;
        }
    </script>
</body>
</html>
